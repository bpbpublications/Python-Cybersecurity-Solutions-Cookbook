# exploitable_package_control.py

"""
Description:
    This security controls uses debsecan to look for exploitable package and lists all the exploits (CVEs) on 
    a system using CVSS database.

Author:
    Nishant Krishna

Chapter:
    Chapter 12 - Defensive Security Techniques
    
Created:
    20 February, 2023
"""

import subprocess


class ExploitablePackageControl:
    def get_exploitable_packages(self):
        output = subprocess.check_output('debsecan', shell=True)
        output_list = output.decode('utf-8').split('\n')
        print('Exploitable packages found on this system:\n', output_list)


if __name__ == "__main__":
    exploitable_packages = ExploitablePackageControl()
    exploitable_packages.get_exploitable_packages()
